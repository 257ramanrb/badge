#!/usr/bin/env ruby

$:.push File.expand_path("../../lib", __FILE__)

require 'badge'
require 'commander'

HighLine.track_eof = false

class BadgeApplication
  include Commander::Methods

  def run
    program :version, Badge::VERSION
    program :description, 'Add a beta badge to your app icon'
    program :help, 'Author', 'Daniel Griesser <daniel.griesser.86@gmail.com>'
    program :help, 'Website', 'https://github.com/HazAT/badge'
    program :help, 'GitHub', 'https://github.com/HazAT/badge'
    program :help_formatter, :compact

    global_option('--verbose', 'Shows a more verbose output') { $verbose = true }

    always_trace!

    default_command :existing_project

    command :existing_project do |c|
      c.syntax = 'badge'
      c.description = "adds a beta badge to your app icon"
      c.option '--dark', 'adds a dark badge instead of the white'
      c.option '--custom STRING', String, 'overlay a custom image on your icon'
      c.option '--no_badge', 'removes the beta badge'
      c.option '--shield STRING', String, 'overlay a shield from shield.io on your icon, eg: Version-1.2-green'

      c.action do |args, options|
        Badge::Runner.new.run('.', options.dark, options.custom, options.no_badge, options.shield)
      end
    end

    run!
  end
end


begin
  BadgeApplication.new.run
end
